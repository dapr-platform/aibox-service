# AI 盒子服务数据库模式目录

本目录包含 AI 盒子服务的数据库模式定义，使用 goose 进行数据库版本控制和迁移。

## 文件列表

- **022_aibox_service.sql**: 创建 AI 盒子相关的基本数据模型，包括设备表、事件表及相关视图
  - 设备表 (o_aibox_device): 存储 AI 盒子设备的基本信息，包括设备名称、IP 地址、心跳时间和状态等
  - 事件表 (o_aibox_event): 存储 AI 盒子设备产生的各类事件，包括事件级别、状态等
  - 设备信息视图 (v_aibox_device_info): 提供设备及其关联事件的详细信息
  - 事件详情视图 (v_aibox_event_info): 提供事件及其关联设备的详细信息
  - 事件统计视图 (v_aibox_active_event_stats): 按级别统计活动事件数量

## 数据模型设计说明

### 设备模型

设备表记录 AI 盒子设备的基本信息，包括设备标识、名称、IP 地址、构建时间、心跳时间和状态。状态用于标识设备是否在线。

### 事件模型

事件表记录由 AI 盒子设备产生的各类事件信息，包括事件标识、设备编号、标题、设备 ID、内容、图片信息、事件级别和状态。
事件级别分为紧急、严重、轻微和警告四个级别，用于标识事件的紧急程度。
事件状态分为清除和活动两种，用于标识事件是否已处理。

### 视图设计

设计了多个视图以方便查询和统计：

- 设备信息视图：聚合设备相关的事件统计信息
- 事件详情视图：关联设备信息，提供完整的事件上下文
- 事件统计视图：按事件级别进行统计，方便监控和报警
